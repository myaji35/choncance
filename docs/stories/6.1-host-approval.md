# Story 6.1: Host Application Approval/Rejection

## Status
Ready for Implementation

## Story
**As an** admin,
**I want** to review and approve/reject host applications,
**so that** only qualified hosts can list properties on the platform.

## Acceptance Criteria
1. Admin dashboard shows list of pending host applications
2. Each application displays: applicant name, email, phone, business info, application date
3. Click on application opens detail view
4. Detail view shows all submitted information
5. Admin can approve or reject application
6. Rejection requires reason input (required, min 20 characters)
7. On approval: user.role updated to 'HOST', email notification sent
8. On rejection: application status = REJECTED, rejection reason emailed to applicant
9. Applications filterable by status: PENDING, APPROVED, REJECTED
10. All admin UI in Korean

## Tasks
- [ ] Create admin route: `src/app/admin/hosts/page.tsx`
- [ ] Add role-based access control (only role=ADMIN)
- [ ] List pending host applications from database
- [ ] Create HostApplicationCard component
- [ ] Create detail view: `/admin/hosts/[id]`
- [ ] Display all application fields
- [ ] Add "승인" and "거부" action buttons
- [ ] Create RejectionModal with reason textarea
- [ ] Create Server Actions: approveHost(id), rejectHost(id, reason)
- [ ] Update user.publicMetadata.role = 'HOST' in Clerk on approval
- [ ] Send approval/rejection emails
- [ ] Add status filter tabs
- [ ] Testing: approval flow, rejection flow, email delivery

## Dev Notes
**Database Model:**
```prisma
model HostApplication {
  id              String   @id @default(cuid())
  userId          String   @unique
  businessName    String?
  businessNumber  String?
  representativeName String
  phone           String
  status          ApplicationStatus @default(PENDING)
  rejectionReason String?
  createdAt       DateTime @default(now())
  reviewedAt      DateTime?
  reviewedBy      String?

  user            User     @relation(fields: [userId], references: [id])
}

enum ApplicationStatus {
  PENDING
  APPROVED
  REJECTED
}
```

**Approval Logic:**
```typescript
async function approveHost(applicationId: string) {
  const app = await prisma.hostApplication.update({
    where: { id: applicationId },
    data: {
      status: 'APPROVED',
      reviewedAt: new Date(),
      reviewedBy: adminUserId
    },
    include: { user: true }
  });

  // Update Clerk role
  await clerkClient.users.updateUserMetadata(app.userId, {
    publicMetadata: {
      role: 'HOST'
    }
  });

  // Send email
  await sendEmail({
    to: app.user.email,
    subject: '호스트 승인 완료',
    template: 'host-approved'
  });
}
```

**Korean Labels:** "호스트 신청 관리", "승인 대기", "승인", "거부", "거부 사유"

## Change Log
| Date | Version | Author |
|------|---------|--------|
| 2025-10-27 | 1.0 | John (PM) |

## Priority: P0 (Critical) | Story Points: 5 | Epic: Admin Features
