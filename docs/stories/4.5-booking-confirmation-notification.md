# Story 4.5: Booking Confirmation and Email Notification

## Status
Ready for Implementation

## Story
**As a** guest who completed payment,
**I want** to receive a booking confirmation with all details,
**so that** I have proof of reservation and know what to expect.

## Acceptance Criteria
1. Immediately after payment success, redirect to `/bookings/[id]/confirmation`
2. Confirmation page displays: booking number, property info, check-in/out dates, guest count, total paid
3. Host contact information shown (name, phone)
4. Booking details downloadable as PDF (optional for MVP)
5. Email sent to guest with confirmation (subject: "예약 확정: [숙소명]")
6. Email sent to host with new booking notification
7. Email includes: booking number, guest name, dates, special requests, contact info
8. Email templates in Korean with professional formatting
9. Confirmation page has CTA: "예약 내역 보기", "숙소에 문의하기"
10. All text in Korean

## Tasks
- [ ] Create confirmation page: `src/app/bookings/[id]/confirmation/page.tsx`
- [ ] Fetch booking data with property and host details
- [ ] Display booking confirmation card with all info
- [ ] Setup email service (Resend or SendGrid)
- [ ] Create email templates: guest-confirmation.tsx, host-notification.tsx
- [ ] Implement Server Action: sendBookingEmails(bookingId)
- [ ] Trigger email sending after payment webhook confirms
- [ ] Add download PDF button (optional - use react-pdf)
- [ ] Testing: page rendering, email delivery, template formatting

## Dev Notes
**Email Service Setup:**
```typescript
import { Resend } from 'resend';

const resend = new Resend(process.env.RESEND_API_KEY);

await resend.emails.send({
  from: 'ChonCance <noreply@choncance.com>',
  to: guest.email,
  subject: `예약 확정: ${property.name}`,
  react: BookingConfirmationEmail({ booking, property, host })
});
```

**Email Template Structure:**
- Header: ChonCance logo
- Greeting: "안녕하세요, [게스트명]님"
- Confirmation message
- Booking details table
- Host contact info
- Cancellation policy link
- Footer: Contact support

**Korean Labels:** "예약 번호", "예약 확정", "체크인", "체크아웃", "호스트 정보"

## Change Log
| Date | Version | Author |
|------|---------|--------|
| 2025-10-27 | 1.0 | John (PM) |

## Priority: P0 | Story Points: 5 | Epic: Epic 4
